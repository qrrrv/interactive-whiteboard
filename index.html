<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Интерактивная Доска - Улучшенная Версия</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.1/spectrum.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Кнопка открытия бокового меню -->
  <button class="sidebar-toggle" id="sidebarToggle">
    <i class="fas fa-palette"></i>
  </button>

  <!-- Скрытая кнопка-посхалка -->
  <button id="easterEggButton">
    <i class="fas fa-eye"></i>
  </button>

  <!-- Боковое меню для выбора тем -->
  <div class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <h3 class="sidebar-title"><i class="fas fa-palette"></i> Темы Оформления</h3>
      <button class="sidebar-close" id="sidebarClose">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="theme-section">
      <div class="section-title">
        <i class="fas fa-fill-drip"></i> Цветовые Темы
      </div>
      <div class="theme-options">
        <div class="theme-option theme-default active" data-theme="default">
          <div class="theme-preview">
            <i class="fas fa-paint-brush"></i>
          </div>
          <div class="theme-name">По умолчанию</div>
        </div>
        <div class="theme-option theme-dark" data-theme="dark">
          <div class="theme-preview">
            <i class="fas fa-moon"></i>
          </div>
          <div class="theme-name">Темная</div>
        </div>
        <div class="theme-option theme-nature" data-theme="nature">
          <div class="theme-preview">
            <i class="fas fa-leaf"></i>
          </div>
          <div class="theme-name">Природа</div>
        </div>
        <div class="theme-option theme-ocean" data-theme="ocean">
          <div class="theme-preview">
            <i class="fas fa-water"></i>
          </div>
          <div class="theme-name">Океан</div>
        </div>
        <div class="theme-option theme-sunset" data-theme="sunset">
          <div class="theme-preview">
            <i class="fas fa-sun"></i>
          </div>
          <div class="theme-name">Закат</div>
        </div>
        <div class="theme-option theme-purple" data-theme="purple">
          <div class="theme-preview">
            <i class="fas fa-gem"></i>
          </div>
          <div class="theme-name">Фиолетовая</div>
        </div>
        <div class="theme-option theme-cosmos" data-theme="cosmos">
          <div class="theme-preview">
            <i class="fas fa-globe-asia"></i>
          </div>
          <div class="theme-name">Космос</div>
        </div>
      </div>
    </div>
    <div class="theme-section">
      <div class="section-title">
        <i class="fas fa-cog"></i> Настройки Интерфейса
      </div>
      <div class="form-group">
        <label for="sidebarWidth">Ширина боковой панели</label>
        <input type="range" class="form-control-range" id="sidebarWidth" min="200" max="400" value="280">
      </div>
      <div class="form-group">
        <label for="animationSpeed">Скорость анимации</label>
        <select class="form-control" id="animationSpeed">
          <option value="slow">Медленно</option>
          <option value="normal" selected>Нормально</option>
          <option value="fast">Быстро</option>
          <option value="none">Без анимации</option>
        </select>
      </div>
      <div class="form-group">
        <label for="cursorStyle">Стиль курсора</label>
        <select class="form-control" id="cursorStyle">
          <option value="default">По умолчанию</option>
          <option value="crosshair">Крест (точность)</option>
          <option value="pointer">Указатель</option>
          <option value="cell">Сетка</option>
          <option value="help">Помощь</option>
          <option value="wait">Ожидание</option>
          <option value="progress">Прогресс</option>
          <option value="none">Нет</option>
          <option value="custom">Свой (URL)</option>
        </select>
      </div>
      <div class="form-group">
        <label for="cursorUrl">URL для курсора (если выбрано "Свой")</label>
        <input type="text" class="form-control" id="cursorUrl" placeholder="Введите URL изображения для курсора">
      </div>
      <div class="form-group form-check">
        <input type="checkbox" class="form-check-input" id="smoothScroll">
        <label class="form-check-label" for="smoothScroll">Плавная прокрутка</label>
      </div>
      <div class="form-group">
        <label for="canvasBgOpacity">Прозрачность фона холста</label>
        <input type="range" class="form-control-range" id="canvasBgOpacity" min="0" max="1" step="0.05" value="1">
      </div>
      <div class="form-group">
        <label for="canvasBgColor">Цвет фона холста</label>
        <input type="text" id="canvasBgColor" />
      </div>
    </div>
    <div class="theme-section">
      <div class="section-title">
        <i class="fas fa-info-circle"></i> Информация
      </div>
      <div class="alert alert-info">
        <small>
          <i class="fas fa-lightbulb"></i> 
          <strong>Совет:</strong> Выбранная тема сохранится автоматически и будет применена при следующем посещении.
        </small>
      </div>
    </div>
  </div>

  <!-- НОВАЯ ПАНЕЛЬ С ФИШКАМИ -->
  <div class="toolbar">
    <div class="toolbar-item" id="nightModeToggle">
      <span class="night-mode-toggle"></span>
      Ночной Режим
    </div>
    <div class="toolbar-item" id="rainbowBrushToggle">
      <span class="rainbow-brush"></span>
      Радужная Кисть
    </div>
    <div class="toolbar-item" id="soundEffectToggle">
      <span class="sound-effect"></span>
      Звуковые Эффекты
    </div>
  </div>

  <div class="container">
    <h1><i class="fas fa-draw-polygon"></i> Интерактивная Доска</h1>
    <!-- Canvas Tabs -->
    <div class="canvas-tabs" id="canvasTabs"></div>
    <!-- Tools Section -->
    <div class="tools-section">
      <div class="tool-btn-card" data-toggle="modal" data-target="#calculatorModal">
        <i class="fas fa-calculator"></i>
        <span>Калькулятор</span>
      </div>
      <div class="tool-btn-card" id="saveCanvasBtn">
        <i class="fas fa-save"></i>
        <span>Сохранить</span>
      </div>
      <div class="tool-btn-card" id="loadCanvasBtn">
        <i class="fas fa-folder-open"></i>
        <span>Загрузить</span>
      </div>
      <div class="tool-btn-card" data-toggle="modal" data-target="#newCanvasModal">
        <i class="fas fa-plus"></i>
        <span>Новый Холст</span>
      </div>
      <div class="tool-btn-card" data-toggle="modal" data-target="#canvasSizeModal">
        <i class="fas fa-expand"></i>
        <span>Размер</span>
      </div>
    </div>
    <div class="whiteboard-container">
      <div class="canvas-wrapper" id="canvasWrapper">
        <canvas id="whiteboard"></canvas>
      </div>
    </div>
    <div class="controls">
      <div class="control-section">
        <div class="control-title"><i class="fas fa-tools"></i> Инструменты Рисования</div>
        <div class="drawing-tools">
          <div class="drawing-tool active" data-mode="pencil" title="Карандаш">
            <i class="fas fa-pencil-alt"></i>
          </div>
          <div class="drawing-tool" data-mode="line" title="Линия">
            <i class="fas fa-minus"></i>
          </div>
          <div class="drawing-tool" data-mode="rectangle" title="Прямоугольник">
            <i class="fas fa-square"></i>
          </div>
          <div class="drawing-tool" data-mode="circle" title="Круг">
            <i class="fas fa-circle"></i>
          </div>
          <div class="drawing-tool" data-mode="text" title="Текст">
            <i class="fas fa-font"></i>
          </div>
          <div class="drawing-tool" data-mode="select" title="Выбор/Перемещение">
            <i class="fas fa-mouse-pointer"></i>
          </div>
        </div>
        <div>
          <button class="btn btn-success btn-tool toggle" id="toggle-drawing">
            <i class="fas fa-pencil-alt"></i> Рисование Включено
          </button>
          <button class="btn btn-danger btn-tool" id="clearCanvasBtn">
            <i class="fas fa-eraser"></i> Очистить
          </button>
          <button class="btn btn-info btn-tool" id="undo-btn">
            <i class="fas fa-undo"></i> Отменить
          </button>
          <button class="btn btn-info btn-tool" id="redo-btn">
            <i class="fas fa-redo"></i> Вернуть
          </button>
        </div>
      </div>
      <div class="control-section">
        <div class="control-title"><i class="fas fa-th"></i> Настройки Сетки</div>
        <div class="grid-controls">
          <button class="grid-btn" id="toggle-grid">
            <i class="fas fa-border-all"></i> Вкл/Выкл Сетку
          </button>
          <button class="grid-btn" data-size="10">
            <i class="fas fa-th"></i> 10px
          </button>
          <button class="grid-btn active" data-size="20">
            <i class="fas fa-th-large"></i> 20px
          </button>
          <button class="grid-btn" data-size="50">
            <i class="fas fa-th-large"></i> 50px
          </button>
        </div>
      </div>
      <div class="control-section">
        <div class="control-title"><i class="fas fa-palette"></i> Выбор Цвета</div>
        <div class="color-palette">
          <div class="color-option active" style="background-color: #000000" data-color="#000000" title="Черный"></div>
          <div class="color-option" style="background-color: #ff0000" data-color="#ff0000" title="Красный"></div>
          <div class="color-option" style="background-color: #00ff00" data-color="#00ff00" title="Зеленый"></div>
          <div class="color-option" style="background-color: #0000ff" data-color="#0000ff" title="Синий"></div>
          <div class="color-option" style="background-color: #ffff00" data-color="#ffff00" title="Желтый"></div>
          <div class="color-option" style="background-color: #ff00ff" data-color="#ff00ff" title="Пурпурный"></div>
          <div class="color-option" style="background-color: #00ffff" data-color="#00ffff" title="Голубой"></div>
          <div class="color-option" style="background-color: #ffa500" data-color="#ffa500" title="Оранжевый"></div>
          <div class="color-option" style="background-color: #800080" data-color="#800080" title="Фиолетовый"></div>
          <div class="color-option" style="background-color: #a52a2a" data-color="#a52a2a" title="Коричневый"></div>
          <div class="color-option" style="background-color: #ffffff; border: 2px solid #ddd;" data-color="#ffffff" title="Белый"></div>
          <div class="color-option" style="background-color: #808080" data-color="#808080" title="Серый"></div>
        </div>
        <input type="text" id="color-picker" />
      </div>
      <div class="control-section">
        <div class="control-title"><i class="fas fa-paint-brush"></i> Настройки Кисти</div>
        <div class="brush-controls">
          <div class="brush-preview" id="brush-preview">5</div>
          <div class="flex-grow-1" style="flex: 1;">
            <label for="brushWidth">Толщина: <span id="brush-width-value">5</span>px</label>
            <input type="range" id="brushWidth" class="form-control-range" value="5" min="1" max="30">
          </div>
        </div>
      </div>
      <div class="control-section" id="shape-controls-section" style="display: none;">
        <div class="control-title"><i class="fas fa-shapes"></i> Настройки Фигур</div>
        <div class="shape-fill-controls">
          <button class="fill-btn active" id="fill-none" data-fill="none">
            <i class="far fa-square"></i> Контур
          </button>
          <button class="fill-btn" id="fill-solid" data-fill="solid">
            <i class="fas fa-square"></i> Заливка
          </button>
        </div>
      </div>
      <div class="control-section" id="text-controls-section" style="display: none;">
        <div class="control-title"><i class="fas fa-font"></i> Настройки Текста</div>
        <div class="text-controls">
          <div class="text-control">
            <label for="fontSize">Размер</label>
            <input type="number" id="fontSize" class="form-control" value="24" min="8" max="72">
          </div>
          <div class="text-control">
            <label for="fontFamily">Шрифт</label>
            <select id="fontFamily" class="form-control">
              <option value="Arial">Arial</option>
              <option value="Helvetica">Helvetica</option>
              <option value="Times New Roman">Times New Roman</option>
              <option value="Courier New">Courier New</option>
              <option value="Georgia">Georgia</option>
              <option value="Verdana">Verdana</option>
            </select>
          </div>
        </div>
      </div>
      <div class="control-section">
        <div class="control-title"><i class="fas fa-layer-group"></i> Управление Слоями</div>
        <div class="layer-controls">
          <button class="layer-btn" id="sendBackwardBtn">
            <i class="fas fa-arrow-down"></i> Назад
          </button>
          <button class="layer-btn" id="bringForwardBtn">
            <i class="fas fa-arrow-up"></i> Вперед
          </button>
          <button class="layer-btn" id="sendToBackBtn">
            <i class="fas fa-arrow-to-bottom"></i> На Задний План
          </button>
          <button class="layer-btn" id="bringToFrontBtn">
            <i class="fas fa-arrow-to-top"></i> На Передний План
          </button>
        </div>
      </div>
    </div>
    <div class="status-bar">
      <div id="status">Готов к рисованию</div>
      <div id="coordinates">X: 0, Y: 0</div>
      <div id="shortcuts-hint"><i class="fas fa-keyboard"></i> Ctrl+Z: Отмена | Ctrl+Y: Возврат</div>
    </div>
    <footer>
      <p><i class="fas fa-heart" style="color: #e74c3c;"></i> Улучшенная Интерактивная Доска 2024</p>
    </footer>
  </div>
  
  <!-- Floating Zoom Panel -->
  <div class="zoom-panel">
    <div class="zoom-panel-title">
      <i class="fas fa-search-plus"></i>
      Зум
    </div>
    <div class="zoom-controls">
      <button class="zoom-btn" id="zoomOutBtn" title="Уменьшить">
        <i class="fas fa-minus"></i>
      </button>
      <div class="zoom-display" id="zoom-display">100%</div>
      <button class="zoom-btn" id="zoomInBtn" title="Увеличить">
        <i class="fas fa-plus"></i>
      </button>
    </div>
    <button class="zoom-btn" id="resetZoomBtn" title="Сброс" style="width: 100%;">
      <i class="fas fa-sync-alt"></i>
    </button>
  </div>

  <!-- New Canvas Modal -->
  <div class="modal fade" id="newCanvasModal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title"><i class="fas fa-plus"></i> Создать Новый Холст</h5>
          <button type="button" class="close" data-dismiss="modal" style="color: white; opacity: 1;">
            <span>&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="canvasName"><strong>Название Холста</strong></label>
            <input type="text" class="form-control" id="canvasName" placeholder="Введите название" value="Новый Холст">
          </div>
          <label><strong>Выберите Размер:</strong></label>
          <div class="canvas-size-controls">
            <div class="size-btn active" data-size="standard">
              <div class="size-icon"><i class="fas fa-square"></i></div>
              <div class="size-label">Стандартный</div>
              <div class="size-dimensions">800×500</div>
            </div>
            <div class="size-btn" data-size="wide">
              <div class="size-icon"><i class="fas fa-arrows-alt-h"></i></div>
              <div class="size-label">Широкий</div>
              <div class="size-dimensions">1200×500</div>
            </div>
            <div class="size-btn" data-size="long">
              <div class="size-icon"><i class="fas fa-arrows-alt-v"></i></div>
              <div class="size-label">Длинный</div>
              <div class="size-dimensions">800×800</div>
            </div>
            <div class="size-btn" data-size="large">
              <div class="size-icon"><i class="fas fa-expand"></i></div>
              <div class="size-label">Большой</div>
              <div class="size-dimensions">1200×800</div>
            </div>
          </div>
          <div class="form-group mt-3">
            <label for="newCanvasWidth"><strong>Или Укажите Свой Размер:</strong></label>
            <input type="number" class="form-control mb-2" id="newCanvasWidth" placeholder="Ширина" min="100" max="2000" value="800">
            <input type="number" class="form-control" id="newCanvasHeight" placeholder="Высота" min="100" max="2000" value="500">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
          <button type="button" class="btn btn-primary" id="createCanvasBtn">
            <i class="fas fa-plus"></i> Создать
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Canvas Size Modal -->
  <div class="modal fade" id="canvasSizeModal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title"><i class="fas fa-expand"></i> Изменить Размер Холста</h5>
          <button type="button" class="close" data-dismiss="modal" style="color: white; opacity: 1;">
            <span>&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="customWidth"><strong>Ширина:</strong></label>
            <input type="number" class="form-control" id="customWidth" value="800" min="100" max="2000">
          </div>
          <div class="form-group">
            <label for="customHeight"><strong>Высота:</strong></label>
            <input type="number" class="form-control" id="customHeight" value="500" min="100" max="2000">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Отмена</button>
          <button type="button" class="btn btn-primary" id="applyCustomSizeBtn">Применить</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Calculator Modal -->
  <div class="modal fade" id="calculatorModal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-sm" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title"><i class="fas fa-calculator"></i> Калькулятор</h5>
          <button type="button" class="close" data-dismiss="modal" style="color: white; opacity: 1;">
            <span>&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="calculator">
            <div class="calculator-display-container">
              <div class="calculator-operation" id="calcOperation"></div>
              <div class="calculator-display" id="calcDisplay">0</div>
            </div>
            <button class="calculator-btn clear" id="calcClear">C</button>
            <button class="calculator-btn delete" id="calcDelete">⌫</button>
            <button class="calculator-btn operator" data-operator="%">%</button>
            <button class="calculator-btn operator" data-operator="/">/</button>
            <button class="calculator-btn" data-number="7">7</button>
            <button class="calculator-btn" data-number="8">8</button>
            <button class="calculator-btn" data-number="9">9</button>
            <button class="calculator-btn operator" data-operator="*">×</button>
            <button class="calculator-btn" data-number="4">4</button>
            <button class="calculator-btn" data-number="5">5</button>
            <button class="calculator-btn" data-number="6">6</button>
            <button class="calculator-btn operator" data-operator="-">-</button>
            <button class="calculator-btn" data-number="1">1</button>
            <button class="calculator-btn" data-number="2">2</button>
            <button class="calculator-btn" data-number="3">3</button>
            <button class="calculator-btn operator" data-operator="+">+</button>
            <button class="calculator-btn" data-number="0" style="grid-column: span 2;">0</button>
            <button class="calculator-btn" id="calcDecimal">.</button>
            <button class="calculator-btn equals" id="calcEquals">=</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.1/spectrum.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.5.0/fabric.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
